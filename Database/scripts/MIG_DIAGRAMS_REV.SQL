DECLARE
V_COUNT NUMBER;
BEGIN

   SAVEPOINT start_tran;
/*
INSERT INTO ICD_USER (USER_ID, FIRST_NAME, LAST_NAME, USER_NAME, LL_ROLE_ID, CREATED_DT, CREATED_BY, LAST_UPDATED_DT, LAST_UPDATED_BY, SESSION_IDENTIFIER, LOGIN_TIME,LAST_UPDATE_TS, APPLICATION_LOGGED    )
SELECT * FROM CADDIS.ICD_USER WHERE USER_ID NOT IN (SELECT USER_ID FROM ICD_USER );


 INSERT INTO ICD_DIAGRAM_REV ( REV_DIAGRAM_ID, ORIGINAL_DIAGRAM_ID, LL_DIAGRAM_STATUS_ID, DIAGRAM_NAME, DIAGRAM_COLOR, DIAGRAM_WIDTH, DIAGRAM_HEIGHT, DIAGRAM_DESC, 
        CREATED_BY, CREATED_DT, LAST_UPDATED_DT,LOCKED_BY_USER_ID, IS_GOLD_SEAL,KEYWORDS,LOCATION, LAST_UPDATED_BY, IS_PUBLIC  )
                 SELECT * FROM CADDIS.ICD_DIAGRAM_REV WHERE REV_DIAGRAM_ID NOT IN ( SELECT REV_DIAGRAM_ID FROM  ICD_DIAGRAM_REV);

----------------ISSUE --------
 INSERT INTO ICD_SHAPE_REV (REV_SHAPE_ID, PARENT_REV_SHAPE_ID, SHAPE_LABEL, SHAPE_COLOR, SHAPE_WIDTH, SHAPE_HEIGHT, SHAPE_THICKNESS, SHAPE_TYPE, LL_LEGEND_FILTER_ID, TOP_LEFT_CORNER_PT_X, TOP_LEFT_CORNER_PT_Y, SHAPE_BIN_INDEX, LL_SHAPE_LABEL_SYMBOL_ID)
                 SELECT * FROM CADDIS.ICD_SHAPE_REV WHERE REV_SHAPE_ID NOT IN ( SELECT REV_SHAPE_ID FROM  ICD_SHAPE_REV) 
                                                                                   AND LL_LEGEND_FILTER_ID  IN ( SELECT LL_ID FROM P_LIST_ITEM) ;
                 
  INSERT INTO ICD_DIAGRAM_SHAPE_JOIN_REV ( REV_DIAGRAM_SHAPE_JOIN_ID, REV_DIAGRAM_ID, REV_SHAPE_ID)
                 SELECT * FROM CADDIS.ICD_DIAGRAM_SHAPE_JOIN_REV WHERE REV_DIAGRAM_SHAPE_JOIN_ID NOT IN ( SELECT REV_DIAGRAM_SHAPE_JOIN_ID FROM  ICD_DIAGRAM_SHAPE_JOIN_REV);           
   
     INSERT INTO ICD_SHAPE_LINKAGE_REV
                 SELECT * FROM CADDIS.ICD_SHAPE_LINKAGE_REV WHERE REV_SHAPE_LINKAGE_ID NOT IN ( SELECT REV_SHAPE_LINKAGE_ID FROM  ICD_SHAPE_LINKAGE_REV);       
*/                                 
  
  FOR A IN   (  SELECT     REV_LINKAGE_CITATION_JOIN_ID, REV_SHAPE_LINKAGE_ID, CASE CITATION_ID WHEN 2729 THEN 2701 
                                                                                                                            WHEN 2725 THEN 2706
                                                                                                                            WHEN 1947 THEN 724
                                                                                                                            ELSE CITATION_ID
                                                                                                                   END AS CITATION_ID 
                   FROM CADDIS.ICD_LINKAGE_CITATION_JOIN_REV 
                   WHERE REV_LINKAGE_CITATION_JOIN_ID NOT IN ( SELECT REV_LINKAGE_CITATION_JOIN_ID FROM  ICD_LINKAGE_CITATION_JOIN_REV)
                      AND CITATION_ID NOT IN (2665, 1903 ))
   LOOP
   
    SELECT COUNT(REV_LINKAGE_CITATION_JOIN_ID) INTO V_COUNT  FROM ICD_LINKAGE_CITATION_JOIN_REV
                  WHERE REV_SHAPE_LINKAGE_ID = A.REV_SHAPE_LINKAGE_ID
                   AND  CITATION_ID = A.CITATION_ID;
                   
                 IF ( V_COUNT = 0) THEN 
                   INSERT INTO ICD_LINKAGE_CITATION_JOIN_REV(REV_LINKAGE_CITATION_JOIN_ID, REV_SHAPE_LINKAGE_ID, CITATION_ID)
                    VALUES( A.REV_LINKAGE_CITATION_JOIN_ID, A.REV_SHAPE_LINKAGE_ID, A.CITATION_ID );
                 END IF;
          
   END LOOP;
           
-------------
/*
 INSERT INTO ICD_LINE_REV ( REV_LINE_ID, LINE_COLOR, LINE_THICKNESS, LINE_TYPE)
                 SELECT * FROM CADDIS.ICD_LINE_REV WHERE REV_LINE_ID NOT IN (SELECT REV_LINE_ID FROM ICD_LINE_REV);
 

                 
 INSERT INTO ICD_DIAGRAM_LINE_JOIN_REV ( REV_DIAGRAM_LINE_JOIN_ID, REV_DIAGRAM_ID, REV_LINE_ID)
                 SELECT * FROM CADDIS.ICD_DIAGRAM_LINE_JOIN_REV WHERE REV_DIAGRAM_LINE_JOIN_ID NOT IN ( SELECT REV_DIAGRAM_LINE_JOIN_ID FROM  ICD_DIAGRAM_LINE_JOIN_REV);
                                 
 INSERT INTO ICD_SHAPE_LINE_JOIN_REV ( REV_SHAPE_LINE_JOIN_ID, REV_DIAGRAM_ID, REV_SHAPE_ID, REV_LINE_ID, EDGE_INDEX, START_PT)
                 SELECT * FROM CADDIS.ICD_SHAPE_LINE_JOIN_REV WHERE REV_SHAPE_LINE_JOIN_ID NOT IN ( SELECT REV_SHAPE_LINE_JOIN_ID FROM  ICD_SHAPE_LINE_JOIN_REV);

 INSERT INTO ICD_POINT_REV 
                 SELECT * FROM CADDIS.ICD_POINT_REV WHERE REV_POINT_ID NOT IN ( SELECT REV_POINT_ID FROM  ICD_POINT_REV);
                 
 INSERT INTO ICD_LINE_POINT_JOIN_REV ( REV_LINE_POINT_JOIN_ID, REV_POINT_ID, REV_LINE_ID)
                 SELECT * FROM CADDIS.ICD_LINE_POINT_JOIN_REV WHERE REV_LINE_POINT_JOIN_ID NOT IN ( SELECT REV_LINE_POINT_JOIN_ID FROM  ICD_LINE_POINT_JOIN_REV);
                 

 
 INSERT INTO ICD_NON_COLLAPSIBLE_BIN_REV
                 SELECT * FROM CADDIS.ICD_NON_COLLAPSIBLE_BIN_REV WHERE REV_NON_COLLAPSIBLE_BIN_ID NOT IN ( SELECT REV_NON_COLLAPSIBLE_BIN_ID FROM  ICD_NON_COLLAPSIBLE_BIN_REV);
*/
 EXCEPTION
  WHEN OTHERS THEN
    ROLLBACK TO start_tran;
    RAISE;
                                                
END;